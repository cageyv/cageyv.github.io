<!doctype html><html lang=en><head><title>MVP on AWS: PostgreSQL · Vladimir Samoylov</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self' https://cdnjs.cloudflare.com/ajax/libs/photoswipe/; object-src 'none'; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net/ https://cdnjs.cloudflare.com/ajax/libs/photoswipe/; script-src 'self' 'unsafe-inline' https://code.jquery.com/ https://cdnjs.cloudflare.com/ajax/libs/photoswipe/ https://twemoji.maxcdn.com https://static.cloudflareinsights.com/; prefetch-src 'self'; connect-src 'self';"><meta name=author content="Vladimir Samoylov"><meta name=description content="Why PostgreSQL? Link to heading Let&rsquo;s assume that you already decided on PostgreSQL as your database. Why? Because it is a powerful, open-source object-relational database system with over 30 years of active development, correct? We will leave the problem of where and how to store data for another time.
RDS Aurora (PostgreSQL Compatible) or RDS PostgreSQL Link to heading If there are no specific requirements, we may select Aurora as the default option."><meta name=keywords content="devops,k8s,aws,terraform,cloud,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="MVP on AWS: PostgreSQL"><meta name=twitter:description content="Why PostgreSQL? Link to heading Let&rsquo;s assume that you already decided on PostgreSQL as your database. Why? Because it is a powerful, open-source object-relational database system with over 30 years of active development, correct? We will leave the problem of where and how to store data for another time.
RDS Aurora (PostgreSQL Compatible) or RDS PostgreSQL Link to heading If there are no specific requirements, we may select Aurora as the default option."><meta property="og:title" content="MVP on AWS: PostgreSQL"><meta property="og:description" content="Why PostgreSQL? Link to heading Let&rsquo;s assume that you already decided on PostgreSQL as your database. Why? Because it is a powerful, open-source object-relational database system with over 30 years of active development, correct? We will leave the problem of where and how to store data for another time.
RDS Aurora (PostgreSQL Compatible) or RDS PostgreSQL Link to heading If there are no specific requirements, we may select Aurora as the default option."><meta property="og:type" content="article"><meta property="og:url" content="https://cageyv.dev/posts/aws-mvp-postgresql/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-21T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-21T00:00:00+00:00"><meta property="og:see_also" content="https://cageyv.dev/posts/aws-rds-data-api/"><meta property="og:see_also" content="https://cageyv.dev/posts/aws-static-hosting/"><meta property="og:see_also" content="https://cageyv.dev/posts/aws-solutions-architect-professional/"><meta property="og:see_also" content="https://cageyv.dev/posts/aws-cloudgaming/"><meta property="og:see_also" content="https://cageyv.dev/posts/aws-vault/"><link rel=canonical href=https://cageyv.dev/posts/aws-mvp-postgresql/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.e1bdf152d93b060b06ba5d496486ed9c201a8b95d335e035beb5faebe3b61cad.css integrity="sha256-4b3xUtk7BgsGul1JZIbtnCAai5XTNeA1vrX66+O2HK0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/extender.min.dd1bfc7c760f0f4622751e65a9b0ac7977915e70a1cf2faf42784bfbe851c4a1.css integrity="sha256-3Rv8fHYPD0YidR5lqbCseXeRXnChzy+vQnhL++hRxKE=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Vladimir Samoylov</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/experience/>Experience</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/education/>Education</a></li><li class=navigation-item><a class=navigation-link href=/recommend/>Recommend</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://cageyv.dev/posts/aws-mvp-postgresql/>MVP on AWS: PostgreSQL</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2024-11-21T00:00:00Z>November 21, 2024</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
6-minute read</span></div><div class=categories><i class="fa fa-folder" aria-hidden=true></i>
<a href=/categories/aws/>aws</a></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/aws/>aws</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/rds/>rds</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/postgresql/>postgresql</a></span></div></div></header><div class=post-content><h2 id=why-postgresql>Why PostgreSQL?
<a class=heading-link href=#why-postgresql><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Let&rsquo;s assume that you already decided on PostgreSQL as your database. Why? Because it is a powerful, open-source object-relational database system with over 30 years of active development, correct? We will leave the problem of where and how to store data for another time.</p><h2 id=rds-aurora-postgresql-compatible-or-rds-postgresql>RDS Aurora (PostgreSQL Compatible) or RDS PostgreSQL
<a class=heading-link href=#rds-aurora-postgresql-compatible-or-rds-postgresql><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>If there are no specific requirements, we may select Aurora as the default option.
Storage systems are the key difference between the two. You don&rsquo;t have to worry about being out of space. Aurora will help you. Aurora will automatically scale the storage up to 128 TB (November 2024). &ldquo;The data is automatically replicated across Availability Zones, your data is highly durable with less possibility of data loss.&rdquo; You can have one instance with data in 3 different places. If you want to add another region, it will give us six different places in the world where data is stored. Magic, right?</p><h2 id=postgresql-parameters>PostgreSQL parameters
<a class=heading-link href=#postgresql-parameters><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>There are many parameters that could be changed. But let&rsquo;s focus on the most important and popular.
Please create two custom parameter groups for cluster and, for instance, in advance and don&rsquo;t use the default ones. We are unable to modify the defaults, and some parameters require a cluster/instance reboot.</p><ul><li><code>log_min_duration_statement = 4000</code> - The duration of the statement in milliseconds beyond which statements will be logged. 0 logs all statements. The default is -1, logging is disabled. <a href=https://www.postgresql.org/docs/current/runtime-config-logging.html#GUC-LOG-MIN-DURATION-STATEMENT class=external-link target=_blank rel=noopener>More info</a></li><li><code>rds.force_ssl = 1</code> - Forces the use of SSL for all connections. The default is 0 (off). Force the encryption in transit. <a href=https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/PostgreSQL.Concepts.General.SSL.html class=external-link target=_blank rel=noopener>More info</a></li><li><code>log_lock_waits = 1</code> - Logs long lock waits. The default is off. <a href=https://www.postgresql.org/docs/current/runtime-config-logging.html#GUC-LOG-LOCK-WAITS class=external-link target=_blank rel=noopener>More info</a></li><li><code>max_locks_per_transaction</code> - Sets the maximum number of locks per transaction. The default is 64. <a href=https://www.postgresql.org/docs/current/runtime-config-locks.html#GUC-MAX-LOCKS-PER-TRANSACTION class=external-link target=_blank rel=noopener>More info</a></li><li><code>shared_preload_libraries = pg_stat_statements,pgaudit</code> - Specifies one or more shared libraries to preload into server memory. The default is an empty string. More info: <a href=https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Appendix.PostgreSQL.CommonDBATasks.Extensions.html class=external-link target=_blank rel=noopener>https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Appendix.PostgreSQL.CommonDBATasks.Extensions.html</a></li><li><code>idle_in_transaction_session_timeout = 300000</code> - Terminate any session with an open transaction that has been idle for longer than the specified duration in milliseconds. The default is 0 (off). <a href=https://www.postgresql.org/docs/current/runtime-config-client.html#GUC-IDLE-IN-TRANSACTION-SESSION-TIMEOUT class=external-link target=_blank rel=noopener>More info</a></li><li><code>log_autovacuum_min_duration = 60000</code> - Sets the minimum execution time above which autovacuum actions will be logged. The default is -1, logging is disabled. <a href=https://www.postgresql.org/docs/current/runtime-config-logging.html#GUC-LOG-AUTOVACUUM-MIN-DURATION class=external-link target=_blank rel=noopener>More info</a></li></ul><h2 id=creation-from-the-console-process>Creation from the console process
<a class=heading-link href=#creation-from-the-console-process><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Let&rsquo;s assume that our urgent needs and luck of time and knowledge force us to use the console. What better to select, where to click?</p><ol><li>Choose the production template always. Fix the DB cluster identifier, it will be used in the connection string. Use any root username. Follow the defaults for AWS Secrets Manager Integration. It will add automatic root password rotation.</li></ol><p><img src=/images/posts/aws_mvp_postresql/1.webp alt=Image></p><ol start=2><li>Size and Storage. Use Aurora Standard and any T class to optimize the budget a bit. You could change it later.</li></ol><p><img src=/images/posts/aws_mvp_postresql/2.webp alt=Image></p><ol start=3><li>Serverless v2. If you use it very rarely and have no idea about the load, you could use the serverless v2. It will scale automatically. From 0 to the sky. Much more expensive, but very flexible.</li></ol><p><img src=/images/posts/aws_mvp_postresql/3.webp alt=Image></p><ol start=4><li>Connectivity. ATTENTION! Do not use the default VPC here. It takes around 5-10 minutes to clickops a separate VPC. And after database creation, you can&rsquo;t change its VPC. Significant moment. Moving a production database could cost you many hours. The same for public access. Avoid it. Use VPNs, Direct Connect, Balancers, and RDS Proxy. It takes time to understand what is consuming the database from the outside.</li></ol><p><img src=/images/posts/aws_mvp_postresql/4.webp alt=Image></p><ol start=5><li>Connectivity again. Don&rsquo;t use the default security group (firewall). Just create a new one. Even if the rules will be bad and wrong, it is better to have a separate entity that will be used only for this database.</li></ol><p><img src=/images/posts/aws_mvp_postresql/5.webp alt=Image></p><ol start=6><li><p>Database parameters. Choose the custom parameter groups that were created above. Not default. It is possible to change, but requires an instance/cluster reboot.</p></li><li><p>Encryption at rest. Always create a separate multi-region KMS key. At least one Customer Managed KMS key could help a lot. We can&rsquo;t change encryption parameters after the database creation. The same applies to the performance insights.</p></li></ol><p><img src=/images/posts/aws_mvp_postresql/7.webp alt=Image></p><h2 id=creation-from-terrafom>Creation from Terrafom
<a class=heading-link href=#creation-from-terrafom><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>The same thing as above, but as code.
There is no need to repeat that again. This code is already available.
<a href=https://github.com/terraform-aws-modules/terraform-aws-rds-aurora/blob/master/examples/postgresql/main.tf class=external-link target=_blank rel=noopener>https://github.com/terraform-aws-modules/terraform-aws-rds-aurora/blob/master/examples/postgresql/main.tf</a></p><div class=highlight><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#fff;font-weight:700>provider</span> <span style=color:#0ff;font-weight:700>&#34;aws&#34;</span> {
</span></span><span style=display:flex><span>  region = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>region</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>data</span> <span style=color:#0ff;font-weight:700>&#34;aws_availability_zones&#34; &#34;available&#34;</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>locals</span> {
</span></span><span style=display:flex><span>  name   = <span style=color:#0ff;font-weight:700>&#34;ex-${basename(path.cwd)}&#34;</span>
</span></span><span style=display:flex><span>  region = <span style=color:#0ff;font-weight:700>&#34;eu-west-1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  vpc_cidr = <span style=color:#0ff;font-weight:700>&#34;10.0.0.0/16&#34;</span>
</span></span><span style=display:flex><span>  azs      = <span style=color:#fff;font-weight:700>slice</span>(<span style=color:#fff;font-weight:700>data</span>.<span style=color:#fff;font-weight:700>aws_availability_zones</span>.<span style=color:#fff;font-weight:700>available</span>.<span style=color:#fff;font-weight:700>names</span>, <span style=color:#ff0;font-weight:700>0</span>, <span style=color:#ff0;font-weight:700>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags = {
</span></span><span style=display:flex><span>    Example    = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>name</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#007f7f>
</span></span></span><span style=display:flex><span><span style=color:#007f7f>
</span></span></span><span style=display:flex><span><span style=color:#007f7f>################################################################################
</span></span></span><span style=display:flex><span><span style=color:#007f7f># RDS Aurora Module
</span></span></span><span style=display:flex><span><span style=color:#007f7f>################################################################################
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>module</span> <span style=color:#0ff;font-weight:700>&#34;aurora&#34;</span> {
</span></span><span style=display:flex><span>  source  = <span style=color:#0ff;font-weight:700>&#34;terraform-aws-modules/rds-aurora/aws&#34;</span>
</span></span><span style=display:flex><span>  version = <span style=color:#0ff;font-weight:700>&#34;~&gt; 9.0&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  name            = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>name</span>
</span></span><span style=display:flex><span>  engine          = <span style=color:#0ff;font-weight:700>&#34;aurora-postgresql&#34;</span>
</span></span><span style=display:flex><span>  engine_version  = <span style=color:#0ff;font-weight:700>&#34;16.3&#34;</span>
</span></span><span style=display:flex><span>  master_username = <span style=color:#0ff;font-weight:700>&#34;pgroot&#34;</span>
</span></span><span style=display:flex><span>  storage_encrypted = <span style=color:#fff;font-weight:700>true</span>
</span></span><span style=display:flex><span>  kms_key_id        = <span style=color:#fff;font-weight:700>module</span>.<span style=color:#fff;font-weight:700>kms</span>.<span style=color:#fff;font-weight:700>key_id</span>
</span></span><span style=display:flex><span>  instances = {
</span></span><span style=display:flex><span>    1 = {
</span></span><span style=display:flex><span>      instance_class          = <span style=color:#0ff;font-weight:700>&#34;db.t4.medium&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  vpc_id               = <span style=color:#fff;font-weight:700>module</span>.<span style=color:#fff;font-weight:700>vpc</span>.<span style=color:#fff;font-weight:700>vpc_id</span>
</span></span><span style=display:flex><span>  db_subnet_group_name = <span style=color:#fff;font-weight:700>module</span>.<span style=color:#fff;font-weight:700>vpc</span>.<span style=color:#fff;font-weight:700>database_subnet_group_name</span>
</span></span><span style=display:flex><span>  security_group_rules = {
</span></span><span style=display:flex><span>    vpc_ingress = {
</span></span><span style=display:flex><span>      cidr_blocks = <span style=color:#fff;font-weight:700>module</span>.<span style=color:#fff;font-weight:700>vpc</span>.<span style=color:#fff;font-weight:700>private_subnets_cidr_blocks</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  apply_immediately   = <span style=color:#fff;font-weight:700>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  engine_lifecycle_support = <span style=color:#0ff;font-weight:700>&#34;open-source-rds-extended-support-disabled&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  create_db_cluster_parameter_group      = <span style=color:#fff;font-weight:700>true</span>
</span></span><span style=display:flex><span>  db_cluster_parameter_group_name        = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>name</span>
</span></span><span style=display:flex><span>  db_cluster_parameter_group_family      = <span style=color:#0ff;font-weight:700>&#34;aurora-postgresql16&#34;</span>
</span></span><span style=display:flex><span>  db_cluster_parameter_group_description = <span style=color:#0ff;font-weight:700>&#34;${local.name} example cluster parameter group&#34;</span>
</span></span><span style=display:flex><span>  db_cluster_parameter_group_parameters = [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;log_min_duration_statement&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#ff0;font-weight:700>4000</span>
</span></span><span style=display:flex><span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;immediate&#34;</span>
</span></span><span style=display:flex><span>      }, {
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;rds.force_ssl&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#ff0;font-weight:700>1</span>
</span></span><span style=display:flex><span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;immediate&#34;</span>
</span></span><span style=display:flex><span>      }, {
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;log_lock_waits&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#0ff;font-weight:700>&#34;1&#34;</span>
</span></span><span style=display:flex><span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;immediate&#34;</span>
</span></span><span style=display:flex><span>      }, {
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;max_locks_per_transaction&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#0ff;font-weight:700>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;pending-reboot&#34;</span>
</span></span><span style=display:flex><span>      }, {
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;shared_preload_libraries&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#0ff;font-weight:700>&#34;pg_stat_statements,pgaudit&#34;</span>
</span></span><span style=display:flex><span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;pending-reboot&#34;</span>
</span></span><span style=display:flex><span>      }, {  
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;idle_in_transaction_session_timeout&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#0ff;font-weight:700>&#34;300000&#34;</span><span style=color:#007f7f> # Max 5 minutes per transaction
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;immediate&#34;</span>
</span></span><span style=display:flex><span>      }, {
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;log_autovacuum_min_duration&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#0ff;font-weight:700>&#34;60000&#34;</span><span style=color:#007f7f> # 1m, minimum execution time above which autovacuum actions will be logged
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;immediate&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  create_db_parameter_group      = <span style=color:#fff;font-weight:700>true</span>
</span></span><span style=display:flex><span>  db_parameter_group_name        = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>name</span>
</span></span><span style=display:flex><span>  db_parameter_group_family      = <span style=color:#0ff;font-weight:700>&#34;aurora-postgresql16&#34;</span>
</span></span><span style=display:flex><span>  db_parameter_group_description = <span style=color:#0ff;font-weight:700>&#34;${local.name} example DB parameter group&#34;</span>
</span></span><span style=display:flex><span>  db_parameter_group_parameters = [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      name         = <span style=color:#0ff;font-weight:700>&#34;log_min_duration_statement&#34;</span>
</span></span><span style=display:flex><span>      value        = <span style=color:#ff0;font-weight:700>4000</span>
</span></span><span style=display:flex><span>      apply_method = <span style=color:#0ff;font-weight:700>&#34;immediate&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  enabled_cloudwatch_logs_exports = [<span style=color:#0ff;font-weight:700>&#34;postgresql&#34;</span>]
</span></span><span style=display:flex><span>  create_cloudwatch_log_group     = <span style=color:#fff;font-weight:700>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  cloudwatch_log_group_tags = {
</span></span><span style=display:flex><span>    Sensitivity = <span style=color:#0ff;font-weight:700>&#34;high&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>tags</span>
</span></span><span style=display:flex><span>}<span style=color:#007f7f>
</span></span></span><span style=display:flex><span><span style=color:#007f7f>
</span></span></span><span style=display:flex><span><span style=color:#007f7f>################################################################################
</span></span></span><span style=display:flex><span><span style=color:#007f7f># Supporting Resources
</span></span></span><span style=display:flex><span><span style=color:#007f7f>################################################################################
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>module</span> <span style=color:#0ff;font-weight:700>&#34;vpc&#34;</span> {
</span></span><span style=display:flex><span>  source  = <span style=color:#0ff;font-weight:700>&#34;terraform-aws-modules/vpc/aws&#34;</span>
</span></span><span style=display:flex><span>  version = <span style=color:#0ff;font-weight:700>&#34;~&gt; 5.0&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  name = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>name</span>
</span></span><span style=display:flex><span>  cidr = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>vpc_cidr</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  azs              = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>azs</span>
</span></span><span style=display:flex><span>  public_subnets   = [<span style=color:#fff;font-weight:700>for</span> <span style=color:#fff;font-weight:700>k</span>, <span style=color:#fff;font-weight:700>v</span> <span style=color:#fff;font-weight:700>in</span> <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>azs</span> <span style=color:red>:</span> <span style=color:#fff;font-weight:700>cidrsubnet</span>(<span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>vpc_cidr</span>, <span style=color:#ff0;font-weight:700>8</span>, <span style=color:#fff;font-weight:700>k</span>)]
</span></span><span style=display:flex><span>  private_subnets  = [<span style=color:#fff;font-weight:700>for</span> <span style=color:#fff;font-weight:700>k</span>, <span style=color:#fff;font-weight:700>v</span> <span style=color:#fff;font-weight:700>in</span> <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>azs</span> <span style=color:red>:</span> <span style=color:#fff;font-weight:700>cidrsubnet</span>(<span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>vpc_cidr</span>, <span style=color:#ff0;font-weight:700>8</span>, <span style=color:#fff;font-weight:700>k</span> <span style=color:red>+</span> <span style=color:#ff0;font-weight:700>3</span>)]
</span></span><span style=display:flex><span>  database_subnets = [<span style=color:#fff;font-weight:700>for</span> <span style=color:#fff;font-weight:700>k</span>, <span style=color:#fff;font-weight:700>v</span> <span style=color:#fff;font-weight:700>in</span> <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>azs</span> <span style=color:red>:</span> <span style=color:#fff;font-weight:700>cidrsubnet</span>(<span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>vpc_cidr</span>, <span style=color:#ff0;font-weight:700>8</span>, <span style=color:#fff;font-weight:700>k</span> <span style=color:red>+</span> <span style=color:#ff0;font-weight:700>6</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>tags</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>module</span> <span style=color:#0ff;font-weight:700>&#34;kms&#34;</span> {
</span></span><span style=display:flex><span>  source  = <span style=color:#0ff;font-weight:700>&#34;terraform-aws-modules/kms/aws&#34;</span>
</span></span><span style=display:flex><span>  version = <span style=color:#0ff;font-weight:700>&#34;~&gt; 2.0&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  deletion_window_in_days = <span style=color:#ff0;font-weight:700>7</span>
</span></span><span style=display:flex><span>  description             = <span style=color:#0ff;font-weight:700>&#34;KMS key for ${local.name} cluster activity stream.&#34;</span>
</span></span><span style=display:flex><span>  enable_key_rotation     = <span style=color:#fff;font-weight:700>true</span>
</span></span><span style=display:flex><span>  is_enabled              = <span style=color:#fff;font-weight:700>true</span>
</span></span><span style=display:flex><span>  key_usage               = <span style=color:#0ff;font-weight:700>&#34;ENCRYPT_DECRYPT&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  aliases = [<span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>name</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags = <span style=color:#fff;font-weight:700>local</span>.<span style=color:#fff;font-weight:700>tags</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=whats-next-other-options>What&rsquo;s next? Other options?
<a class=heading-link href=#whats-next-other-options><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Today we covered the PostgreSQL on RDS Aurora. But there are many other options.
The cheapest is to store the raw data as S3 objects. Durable and replication is available, but it could be slow.
Key-value stores like DynamoDB. It is fast, but it is not a relational database.
The most important thing is to start with the problem and then pick the right tool for it.</p></div><footer><section class=see-also><h3 id=see-also-in-aws>See also in AWS
<a class=heading-link href=#see-also-in-aws><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><nav><ul><li><a href=/posts/aws-rds-data-api/>AWS RDS Data API and CloudTrail. Who drop the table?</a></li><li><a href=/posts/aws-static-hosting/>The Multiverse of Hosting a Static HTML File on AWS</a></li><li><a href=/posts/aws-solutions-architect-professional/>Navigating the Path to AWS Solutions Architect Professional Certification</a></li><li><a href=/posts/aws-cloudgaming/>Where no Windows Machine? Luck of space? Travel a lot? Let's use AWS as is Cloud Gaming platform</a></li><li><a href=/posts/aws-vault/>Security Basics in AWS or How To Get Rid of Hardcoded Credential and Reduce Data Leakage Risks with aws-vault</a></li></ul></nav></section></footer></article></section></div><footer class=footer><section class=container>©
2019 -
2025
Vladimir Samoylov
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>