<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self' https://cdnjs.cloudflare.com/ajax/libs/photoswipe/; object-src 'none'; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net/ https://cdnjs.cloudflare.com/ajax/libs/photoswipe/; script-src 'self' 'unsafe-inline' https://code.jquery.com/ https://cdnjs.cloudflare.com/ajax/libs/photoswipe/ https://twemoji.maxcdn.com https://static.cloudflareinsights.com/; prefetch-src 'self'; connect-src 'self';"><meta name=author content="Vladimir Samoylov"><meta name=description content="Developers often hardcode credentials on a public or private GitHub repository, ramping up data leakage risks. It’s hardly better to store static credentials in the .aws/credentials folder on a server or a local operator machine. As american cryptographer, writer, and computer security specialist, Bruce Schneier, says: . &ldquo;Only amateurs attackWe machines; professionals target people.&rdquo; Therefore, you, not your hardware, is at risk.
By executing fraudulent software, cybercriminals can easily steal all the data from the folder or a whole directory with your, your friends’, and clients’ credentials."><meta name=keywords content="devops,k8s,aws,terraform,cloud,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Security Basics in AWS or How To Get Rid of Hardcoded Credential and Reduce Data Leakage Risks with aws-vault"><meta name=twitter:description content="Developers often hardcode credentials on a public or private GitHub repository, ramping up data leakage risks. It’s hardly better to store static credentials in the .aws/credentials folder on a server or a local operator machine. As american cryptographer, writer, and computer security specialist, Bruce Schneier, says: . &ldquo;Only amateurs attackWe machines; professionals target people.&rdquo; Therefore, you, not your hardware, is at risk.
By executing fraudulent software, cybercriminals can easily steal all the data from the folder or a whole directory with your, your friends’, and clients’ credentials."><meta property="og:title" content="Security Basics in AWS or How To Get Rid of Hardcoded Credential and Reduce Data Leakage Risks with aws-vault"><meta property="og:description" content="Developers often hardcode credentials on a public or private GitHub repository, ramping up data leakage risks. It’s hardly better to store static credentials in the .aws/credentials folder on a server or a local operator machine. As american cryptographer, writer, and computer security specialist, Bruce Schneier, says: . &ldquo;Only amateurs attackWe machines; professionals target people.&rdquo; Therefore, you, not your hardware, is at risk.
By executing fraudulent software, cybercriminals can easily steal all the data from the folder or a whole directory with your, your friends’, and clients’ credentials."><meta property="og:type" content="article"><meta property="og:url" content="https://cageyv.dev/posts/aws-vault/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-14T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-14T00:00:00+00:00"><meta property="og:see_also" content="https://cageyv.dev/posts/aws-cloudtrail-to-slack/"><meta property="og:see_also" content="https://cageyv.dev/posts/aws-ec2-spot/"><title>Security Basics in AWS or How To Get Rid of Hardcoded Credential and Reduce Data Leakage Risks with aws-vault · Vladimir Samoylov</title><link rel=canonical href=https://cageyv.dev/posts/aws-vault/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.1.7" as=font type=font/woff2 integrity="sha256-hEIt6X6xzye8ubyk8/uxjz68cRZHsJxoKS9fQ8idUGQ=" crossorigin><link rel=stylesheet href=/css/coder.min.7845183269a9eb35f70d63bb7521ad5e9470a140d020e12172e0b5d3ed3ec9a3.css integrity="sha256-eEUYMmmp6zX3DWO7dSGtXpRwoUDQIOEhcuC10+0+yaM=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.89c82b6022b96f77aeb521b240daec4f87ea029d84d1c78b8acd0735b91b3c92.css integrity="sha256-icgrYCK5b3eutSGyQNrsT4fqAp2E0ceLis0HNbkbPJI=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><script defer src=https://twemoji.maxcdn.com/v/13.0.1/twemoji.min.js integrity=sha384-5f4X0lBluNY/Ib4VhGx0Pf6iDCF99VGXJIyYy7dDLY5QlEd7Ap0hICSSZA1XYbc4 crossorigin=anonymous></script><meta name=generator content="Hugo 0.102.3"></head><body class=colorscheme-auto onload=twemoji.parse(document.body)><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Vladimir Samoylov</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/experience/>Experience</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/education/>Education</a></li><li class=navigation-item><a class=navigation-link href=/recommend/>Recommend</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://cageyv.dev/posts/aws-vault/>Security Basics in AWS or How To Get Rid of Hardcoded Credential and Reduce Data Leakage Risks with aws-vault</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2022-07-14T00:00:00Z>July 14, 2022</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
6-minute read</span></div><div class=categories><i class="fa fa-folder" aria-hidden=true></i>
<a href=/categories/aws/>aws</a></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<a href=/tags/aws/>aws</a>
<span class=separator>•</span>
<a href=/tags/security/>security</a>
<span class=separator>•</span>
<a href=/tags/credentials/>credentials</a>
<span class=separator>•</span>
<a href=/tags/aws-vault/>aws-vault</a></div></div></header><div><p>Developers often hardcode credentials on a public or private GitHub repository, ramping up data leakage risks. It’s hardly better to store static credentials in the .aws/credentials folder on a server or a local operator machine. As american cryptographer, writer, and computer security specialist, Bruce Schneier, says: . &ldquo;Only amateurs attackWe machines; professionals target people.&rdquo; Therefore, you, not your hardware, is at risk.</p><p>By executing fraudulent software, cybercriminals can easily steal all the data from the folder or a whole directory with your, your friends’, and clients’ credentials. Even the AWS support team is exhausted with constant tickets regarding stolen credentials from public Git repos. Here&rsquo;s why if you commit keys, expect an email in 3-5 minutes saying that the IAM policy has been applied. It means that you can’t get rid of the policy or destroy exposed credentials.</p><p><img src=/images/posts/aws_vault/1.png alt=FistImage></p><p>Even such measures don’t solve the problem. According to the <a href=https://www.techtarget.com/searchsecurity/news/252520686/Verizon-DBIR-Stolen-credentials-led-to-nearly-50-of-attacks>Verizon 2022 Data Breach Investigations Report</a>, there’s been an almost 30% increase in stolen credentials, proving it to be a true-and-tried method to gain unauthorized access to an organization for the past five years. In fact, they account for almost half breaches.</p><p><img src=/images/posts/aws_vault/2.png alt=FistImage></p><p>For the past 12 months, <a href=https://outpost24.com/blog/FTSE-100-compromised-credential-study-2022>31,000+</a> stolen and leaked credentials were detected for FTSE 100 companies, while almost 40% were disclosed on the underground. The same happened with 1 billion records of Chinese <a href=https://www.reuters.com/world/china/hacker-claims-have-stolen-1-bln-records-chinese-citizens-police-2022-07-04/>private citizens’ data</a> stolen from the Shanghai police in Summer 2022. All this was possible due to <a href=https://twitter.com/cz_binance/status/1543905416748359680>exposed credentials</a> on CSDN—the Chinese Software Development Network.</p><p>The worst part — developers can do nothing to prevent the attack even if it’s detected quickly. <a href=https://www.comparitech.com/blog/information-security/github-honeypot/>Honeypot results</a> showed that it takes 1 minute to find exposed credentials and launch attacks. The entire attack lasts only up to 4 minutes from the moment of exposure.</p><h2 id=use-aws-vault-to-securely-store-and-access-aws-credentials-in-a-development-environment>Use aws-vault To Securely Store and Access AWS Credentials in a Development Environment
<a class=heading-link href=#use-aws-vault-to-securely-store-and-access-aws-credentials-in-a-development-environment><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Aws-vault is a tool that has tackled the problem of stolen credentials for six years already. It stores your IAM credentials in a secure keystore and then generates temporary credentials to expose to your shell and applications. Therefore, the keys are not hard-coded or static, which decreases data leakage risks. Here are four key problems that aws-vault solves:</p><ul><li><strong>Secures access to products under development.</strong> An engineer who works on a digital solution can run tests without committing keys in public Git repos. Even if you commit your secrets in a private Git repo, you can face security risks. Since no alerts will be sent, you will find out about the incident when your product is in public access—for example, if you are about to begin a presentation, but the access to the solution is blocked.</li><li><strong>Controls what type of credentials is used.</strong> One common problem a developer faces is not understanding what credential types are used by apps. They can be local, static hardcoded ones, environment variables, containers, EC2 Instance profiles, or ECS Container task roles. Aws-vault populates environment variables but can also emulate EC2 metadata servers and ECS credential servers.</li></ul><p><img src=/images/posts/aws_vault/3.png alt=FistImage></p><ul><li><strong>Provides seamless access across various apps.</strong> Using several accounts is the norm for developers. Each account has its own access permissions. Without hardcoding, you need to think about where to store credentials and how to distribute them across a team securely. With aws-vault, you don’t need to guard your AWS Multi-Account strategy, thinking about whether to commit keys or not. The tool sends dynamic credentials that expire in a short timeframe, which leaves a reduced window of opportunity for a hacker.</li><li><strong>Convenient navigation across several apps.</strong> Since your credentials are of the environment type, infrastructure cloud tools using AWS SDK (for example, Terraform) can easily take them and use them to permit you access. If you want to close all sessions, run the exit command. Any app automatically refreshes dynamic credentials as needed.</li></ul><h2 id=how-to-practice-with-aws-vault>How to Practice With aws-vault
<a class=heading-link href=#how-to-practice-with-aws-vault><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Most likely, currently, your logins and passwords are hardcoded. You may believe that it’s a convenient way to share credentials with your team without passing them over manually. Therefore, your code looks as follows:</p><p><img src=/images/posts/aws_vault/4.png alt=FistImage></p><p>In this case, your data can be easily stolen and used for malicious purposes. Here’s a brief guide on how to boost your credentials’ security with aws-vault:</p><ul><li>Create an AWS account if you don’t have one. Create an IAM user and define roles. They allow you to access keys used with the API or CLI. Set secret keys, passwords, and action and access permissions.</li><li>If you use several AWS profiles, assume temporary privileges for each. You can learn more about how to do this <a href=https://github.com/99designs/aws-vault/blob/master/USAGE.md#using-multiple-profiles>here</a>.</li></ul><p>Once you are set, you can start generating environment credentials with aws-vault. Suppose you have a <strong>primitive JavaScript-based app</strong> to test. You initiate a command for the vault to take dynamic credentials and add them to development environments for the app to run. With AWS SDK, the JavaScript app will get the credentials.</p><p><img src=/images/posts/aws_vault/5.png alt=FistImage></p><p>The process is the same if you want to deliver environmental credentials to a simple docker. Slightly edit a regular docker command, and you will receive environmental credentials.</p><p><img src=/images/posts/aws_vault/6.png alt=FistImage></p><p>Aws-vault also allows you to <strong>simulate the ESC credential server and ES2 Instance Profile</strong>. For example, if you use the tool to deliver the credentials to <strong>docker-compose</strong>, aws-vault will pretend to be a part of the server responsible for credential transfer. The results in the development environment show that aws-vault launched a local simulation with a specific token just as on ESC. There will be remote credentials, while access key and session tokens aren’t transferred.</p><p><img src=/images/posts/aws_vault/7.png alt=FistImage></p><p><img src=/images/posts/aws_vault/8.png alt=FistImage></p><p>If you want to simulate ES2 Instance Profile, the tool will run a local proxy. Here, you can’t avoid using root. As a result, you get EC2 metadata credentials.</p><p><img src=/images/posts/aws_vault/9.png alt=FistImage></p><p>You can learn more about all the explained examples here: <a href=https://github.com/cageyv/aws-vault-examples>https://github.com/cageyv/aws-vault-examples</a></p><h2 id=benefits-of-aws-vault>Benefits of aws-vault
<a class=heading-link href=#benefits-of-aws-vault><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Here are the main benefits of using aws-vault</p><ul><li><strong>Simple functionality.</strong> It takes only a couple of minutes to start using the tool. Basically, you need to create an account, and set IAM and roles, secret keys, and a password to begin.</li><li><strong>Security.</strong> Dynamic passwords that expire within a short timeframe don’t pose security threats, even if they are stolen. A cybercriminal can’t steal them, lie low, and then steal your data or app all of a sudden. Besides, if your company uses AWS Single Sign-on (SSO), aws-vault can also use credentials defined by AWS SSO ClI v2.</li><li><strong>Convenience.</strong> Thanks to AWS SDK, the whole credential chain is supported by default. You don’t need to add configurations, while the apps will refresh dynamic passwords if they expire during your session.</li><li><strong>Local testing.</strong> Aws-vault allows you to test the app in the environment where it will be launched before release. You can spot bugs and fix them without deployment or providing access to admins or DevOps.</li></ul><p>Another service that allows developing and testing apps offline is <a href=https://localstack.cloud>Local Stack</a>. It comes free and paid and serves as a metal developer that builds an app with AWS locally. Local Stack can simulate a lot of AWS services without access to the cloud to provide a seamless coding experience. The tool has a decent open-source database to speed up the coding process and let you focus on business objectives. The same applies to aws-vault, which facilitates credential transfers, reduces sensitive data leakage risks, and allows you to devote more time to meaningful tasks rather than thinking about how to pass keys without hardcoding them.</p></div><footer><section class=see-also><h3 id=see-also-in-aws>See also in AWS
<a class=heading-link href=#see-also-in-aws><i class="fa fa-link" aria-hidden=true></i></a></h3><nav><ul><li><a href=/posts/aws-cloudtrail-to-slack/>What Is AWS CloudTrail, and Why Do You Need It</a></li><li><a href=/posts/aws-ec2-spot/>How To Save Resources With the Terraform Module for AWS Spot Instances</a></li></ul></nav></section></footer></article></section></div><footer class=footer><section class=container><p>Hosted on GitHub Pages.</p>©
2019 -
2022
Vladimir Samoylov</section></footer></main><script src=/js/dark-mode.min.c2d8a1f8f2660e4a46d776277c72695a1e0ca65939d79f754441d47551604af5.js integrity="sha256-wtih+PJmDkpG13YnfHJpWh4Mplk51591REHUdVFgSvU="></script></body></html>